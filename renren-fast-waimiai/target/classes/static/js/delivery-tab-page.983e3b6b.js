(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["delivery-tab-page"],{"0e40":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("van-nav-bar",{staticStyle:{overflow:"auto",background:"#fff6ef"},attrs:{title:"我的"},scopedSlots:e._u([{key:"right",fn:function(){return[r("van-icon",{attrs:{name:"setting-o",size:"25"},on:{click:function(t){return e.$router.push("/deliveryman/setting")}}})]},proxy:!0}])}),r("van-card",{scopedSlots:e._u([{key:"title",fn:function(){return[r("van-row",{attrs:{gutter:"20"}},[r("van-col",[r("van-icon",{attrs:{name:"photo-o",size:"40"}})],1),r("van-col",[r("p",[e._v("用户名")]),r("p",[e._v("送餐员ID")]),r("p",[e._v("饿死就算了。")])])],1)]},proxy:!0}])}),r("van-grid",{attrs:{"column-num":3}},[r("van-grid-item",{attrs:{icon:"balance-list-o",to:"/deliveryman/mine/shop-star",text:"每日收入"}}),r("van-grid-item",{attrs:{icon:"balance-pay",text:"钱包"}}),r("van-grid-item",{attrs:{icon:"service-o",text:"客服"}})],1),r("van-cell-group",{attrs:{title:"已完成订单，下拉刷新"}},[r("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[r("van-list",{staticStyle:{"margin-bottom":"20%"}},[e._l([1,2,3,4],(function(t){return r("van-cell",{key:t,scopedSlots:e._u([{key:"title",fn:function(){return[r("van-row",[r("span",[e._v("11月2日 12:36")])]),r("van-row",[r("van-col",[r("span",[e._v("店铺名")])]),e._v(" "),r("van-col",[r("span",[e._v("地址：xxxxxxxx")])])],1),r("van-row",[r("van-col",[r("span",[e._v("顾客地址：xxxxxxxx")])])],1)]},proxy:!0}],null,!0)})})),e._l([1,2,3,4],(function(t){return r("van-cell",{key:t,scopedSlots:e._u([{key:"title",fn:function(){return[r("van-row",[r("span",[e._v("几分钟前")])]),r("van-row",[r("van-col",[r("span",[e._v("店铺名")])]),e._v(" "),r("van-col",[r("span",[e._v("地址：xxxxxxxx")])])],1),r("van-row",[r("van-col",[r("span",[e._v("顾客地址：xxxxxxxx")])])],1)]},proxy:!0}],null,!0)})}))],2)],1)],1)],1)},o=[],a={name:"Mine"},s=a,i=r("2877"),c=Object(i["a"])(s,n,o,!1,null,"1555df7c",null);t["default"]=c.exports},"1ced":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("van-cell",{staticStyle:{background:"#EFF0F1"}},[r("van-card",{attrs:{price:e.totalPrice(e.order.sendCost+2)},scopedSlots:e._u([{key:"title",fn:function(){return[r("van-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[r("van-collapse-item",{attrs:{title:e.order.shopShopname,name:"1"}},[e._l(e.orderFoods,(function(t){return r("van-cell",{key:t.id},[r("van-card",{attrs:{price:e.totalPrice(t.sellPrice,t.numbers),"origin-price":e.totalPrice(t.originPrice,t.numbers),title:t.title+"  x"+t.numbers,thumb:t.cover}})],1)})),r("span",[e._v("合计：￥"+e._s(e.totalPrice(e.order.totalMoney)))])],2)],1)]},proxy:!0},{key:"tags",fn:function(){return[r("span",[e._v("商家："+e._s(e.order.shopAddress))]),r("br"),r("span",[e._v("顾客："+e._s(e.order.userAddress))]),r("br"),r("span",[e._v(e._s(e.order.userUsername))]),r("br"),r("span",[e._v(e._s(e.order.userMobile))]),r("br")]},proxy:!0},{key:"footer",fn:function(){return["已取消"===e.order.completestatus||"已退款"===e.order.completestatus?r("span",[e._v("此为失效订单，可撤单/召回")]):e._e(),"申请退款中"===e.order.completestatus?r("span",[e._v("此为争议订单，可正常配送")]):e._e(),"商家已接单"===e.order.completestatus?r("van-button",{attrs:{color:"#005ce6",size:"small"},on:{click:e.deliverReceive}},[e._v(" 接单 ")]):e._e(),"配送中"===e.order.completestatus||"申请退款中"===e.order.completestatus?r("van-button",{attrs:{color:"#005ce6",size:"small"},on:{click:e.preDeliverSent}},[e._v("确认送达")]):e._e()]},proxy:!0},{key:"price-top",fn:function(){return[r("span",[e._v(e._s(e.modifiedTime(new Date(e.order.gmtCreate))))]),r("br"),r("span",[e._v(e._s(e.getDate(new Date(e.order.gmtCreate))))]),r("br"),r("span",[e._v("状态："+e._s(e.order.completestatus))]),r("br"),r("span",[e._v("此单收入：")])]},proxy:!0}])})],1)},o=[],a=r("5530"),s=r("ed02"),i=r("2f62"),c=r("d399"),u=r("2241"),l={name:"OrderItem",props:["order","removeItemFromParent"],watch:{updateFlag:function(){this.$forceUpdate()}},methods:{totalPrice:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(s["a"])(e*t)},apiRequestFoods:function(e){var t=this;this.axios.get("/orderfood/"+e).then((function(e){t.orderFoods=e.data.list}))},modifiedTime:function(e){return Object(s["b"])("HH:MM",e)},getDate:function(e){return Object(s["b"])("mm月dd日",e)},deliverReceive:function(){var e=this;this.axios({url:"/deliver/receive/"+this.userInfo.id,method:"post",data:Object(a["a"])(Object(a["a"])({},this.order),{},{deliverName:this.userInfo.truename}),headers:{"content-type":"application/json"}}).then((function(t){0===t.data.code&&(Object(c["a"])({message:"接单成功",type:"success"}),e.removeItemFromParent(e.key))})).catch((function(){Object(c["a"])({message:"接单失败，请重试",type:"fail"})}))},preDeliverSent:function(){var e=this;u["a"].confirm({title:"订单送达",message:"确定订单已送达顾客"}).then((function(){e.deliverSent(e.order.id)})).catch((function(){}))},deliverSent:function(e){var t=this;this.axios.get("/deliver/complete/"+e).then((function(e){0===e.data.code&&(Object(c["a"])({message:"订单已完成",type:"success"}),t.removeItemFromParent(t.key))})).catch((function(){Object(c["a"])({message:"未知问题，请重试",type:"fail"})}))}},data:function(){return{orderFoods:[],activeNames:[]}},mounted:function(){this.apiRequestFoods(this.order.id)},computed:Object(a["a"])({},Object(i["c"])("validate",{userInfo:"userInfo"}))},d=l,v=(r("69cd"),r("2877")),f=Object(v["a"])(d,n,o,!1,null,"99e84c46",null);t["a"]=f.exports},"69cd":function(e,t,r){"use strict";r("f7f5")},e7ef:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("van-nav-bar",{staticStyle:{overflow:"auto",background:"#fff6ef"},attrs:{title:"送单队列"}}),r("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[r("van-list",{staticStyle:{"margin-bottom":"20%"}},[r("van-cell-group",{attrs:{title:"tips:下拉可手动刷新"}},e._l(e.queueOrderList,(function(t){return r("OrderItem",{key:t.id,attrs:{removeItemFromParent:e.removeItemFromParent,order:t}})})),1)],1)],1)],1)},o=[],a=(r("a434"),r("5530")),s=r("d399"),i=r("2f62"),c=r("1ced"),u={name:"Queue",components:{OrderItem:c["a"]},data:function(){return{exampleOrderlist:[{id:9,userId:1,userUsername:"吴sir",userMobile:"18752151001",userAddressId:2,userAddress:"广东金融学院北苑北教广场xxxxxxxxxxxxxxxxxxxxx",note:"啊哈哈哈嘎嘎嘎嘎嘎噶",shopShopname:"正信鸡排",shopMobile:"18752151002",shopAddress:"迎龙路01号",deliverId:null,deliverName:null,deliverMobile:null,shopId:1,boxCost:2,sendCost:1,totalMoney:30,completestatus:"商家已接单",gmtCreate:"2020-11-08 07:06:36",gmtModified:"2020-11-08 07:06:36"}],queueOrderList:[],isLoading:!1}},methods:{apiRequestQueueOrderList:function(e){var t=this;this.axios.get("/deliver/orderlist/"+e).then((function(e){t.queueOrderList=e.data.list})).catch((function(){return Object(s["a"])("请刷新列表")}))},onRefresh:function(){var e=this;setTimeout((function(){e.apiRequestQueueOrderList(e.userInfo.id),e.isLoading=!1}),1e3)},removeItemFromParent:function(e){for(var t=0,r=0;r<this.queueOrderList.length;r++)if(this.queueOrderList[r].id===e){t=r;break}this.queueOrderList.splice(t,1)}},computed:Object(a["a"])({},Object(i["c"])("validate",{userInfo:"userInfo"})),mounted:function(){this.onRefresh()}},l=u,d=r("2877"),v=Object(d["a"])(l,n,o,!1,null,"60d95981",null);t["default"]=v.exports},f7f5:function(e,t,r){}}]);
//# sourceMappingURL=delivery-tab-page.983e3b6b.js.map