(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["delivery-home"],{"1ced":function(e,t,r){"use strict";var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("van-cell",{staticStyle:{background:"#EFF0F1"}},[r("van-card",{attrs:{price:e.totalPrice(e.order.sendCost+2)},scopedSlots:e._u([{key:"title",fn:function(){return[r("van-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[r("van-collapse-item",{attrs:{title:e.order.shopShopname,name:"1"}},[e._l(e.orderFoods,(function(t){return r("van-cell",{key:t.id},[r("van-card",{attrs:{price:e.totalPrice(t.sellPrice,t.numbers),"origin-price":e.totalPrice(t.originPrice,t.numbers),title:t.title+"  x"+t.numbers,thumb:t.cover}})],1)})),r("span",[e._v("合计：￥"+e._s(e.totalPrice(e.order.totalMoney)))])],2)],1)]},proxy:!0},{key:"tags",fn:function(){return[r("span",[e._v("商家："+e._s(e.order.shopAddress))]),r("br"),r("span",[e._v("顾客："+e._s(e.order.userAddress))]),r("br"),r("span",[e._v(e._s(e.order.userUsername))]),r("br"),r("span",[e._v(e._s(e.order.userMobile))]),r("br")]},proxy:!0},{key:"footer",fn:function(){return["已取消"===e.order.completestatus||"已退款"===e.order.completestatus?r("span",[e._v("此为失效订单，可撤单/召回")]):e._e(),"申请退款中"===e.order.completestatus?r("span",[e._v("此为争议订单，可正常配送")]):e._e(),"商家已接单"===e.order.completestatus?r("van-button",{attrs:{color:"#005ce6",size:"small"},on:{click:e.deliverReceive}},[e._v(" 接单 ")]):e._e(),"配送中"===e.order.completestatus||"申请退款中"===e.order.completestatus?r("van-button",{attrs:{color:"#005ce6",size:"small"},on:{click:e.preDeliverSent}},[e._v("确认送达")]):e._e()]},proxy:!0},{key:"price-top",fn:function(){return[r("span",[e._v(e._s(e.modifiedTime(new Date(e.order.gmtCreate))))]),r("br"),r("span",[e._v(e._s(e.getDate(new Date(e.order.gmtCreate))))]),r("br"),r("span",[e._v("状态："+e._s(e.order.completestatus))]),r("br"),r("span",[e._v("此单收入：")])]},proxy:!0}])})],1)},o=[],n=r("5530"),s=r("ed02"),i=r("2f62"),c=r("d399"),d=r("2241"),l={name:"OrderItem",props:["order","removeItemFromParent"],watch:{updateFlag:function(){this.$forceUpdate()}},methods:{totalPrice:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(s["a"])(e*t)},apiRequestFoods:function(e){var t=this;this.axios.get("/orderfood/"+e).then((function(e){t.orderFoods=e.data.list}))},modifiedTime:function(e){return Object(s["b"])("HH:MM",e)},getDate:function(e){return Object(s["b"])("mm月dd日",e)},deliverReceive:function(){var e=this;this.axios({url:"/deliver/receive/"+this.userInfo.id,method:"post",data:Object(n["a"])(Object(n["a"])({},this.order),{},{deliverName:this.userInfo.truename}),headers:{"content-type":"application/json"}}).then((function(t){0===t.data.code&&(Object(c["a"])({message:"接单成功",type:"success"}),e.removeItemFromParent(e.key))})).catch((function(){Object(c["a"])({message:"接单失败，请重试",type:"fail"})}))},preDeliverSent:function(){var e=this;d["a"].confirm({title:"订单送达",message:"确定订单已送达顾客"}).then((function(){e.deliverSent(e.order.id)})).catch((function(){}))},deliverSent:function(e){var t=this;this.axios.get("/deliver/complete/"+e).then((function(e){0===e.data.code&&(Object(c["a"])({message:"订单已完成",type:"success"}),t.removeItemFromParent(t.key))})).catch((function(){Object(c["a"])({message:"未知问题，请重试",type:"fail"})}))}},data:function(){return{orderFoods:[],activeNames:[]}},mounted:function(){this.apiRequestFoods(this.order.id)},computed:Object(n["a"])({},Object(i["c"])("validate",{userInfo:"userInfo"}))},u=l,m=(r("69cd"),r("2877")),v=Object(m["a"])(u,a,o,!1,null,"99e84c46",null);t["a"]=v.exports},"69cd":function(e,t,r){"use strict";r("f7f5")},"6f83":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("iframe",{attrs:{src:"https://apip.weatherdt.com/v2/h5.html?bg=3&md=0&lc=auto&key=MM9wfmemO9",width:"100%",height:"320",frameborder:"0",scrolling:"no",id:"iframename",name:"iframename"}}),r("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[r("van-list",{staticStyle:{"margin-bottom":"20%"}},[r("van-cell-group",{attrs:{title:"tips:下拉可手动刷新"}},e._l(e.preTaskOrderList,(function(t){return r("OrderItem",{key:t.id,attrs:{removeItemFromParent:e.removeItemFromParent,order:t}})})),1)],1)],1)],1)},o=[],n=(r("a434"),r("1ced")),s=r("d399"),i={name:"Home",components:{OrderItem:n["a"]},data:function(){return{exampleOrderlist:[{id:9,userId:1,userUsername:"吴sir",userMobile:"18752151001",userAddressId:2,userAddress:"广东金融学院北苑北教广场xxxxxxxxxxxxxxxxxxxxx",note:"啊哈哈哈嘎嘎嘎嘎嘎噶",shopShopname:"正信鸡排",shopMobile:"18752151002",shopAddress:"迎龙路01号",deliverId:null,deliverName:null,deliverMobile:null,shopId:1,boxCost:2,sendCost:1,totalMoney:30,completestatus:"商家已接单",gmtCreate:"2020-11-08 07:06:36",gmtModified:"2020-11-08 07:06:36"}],preTaskOrderList:[],isLoading:!1}},methods:{apiRequestPreTaskOrderList:function(){var e=this;this.axios.get("/deliver/orderlist").then((function(t){e.preTaskOrderList=t.data.list})).catch((function(){return Object(s["a"])("请刷新列表")}))},onRefresh:function(){var e=this;setTimeout((function(){e.apiRequestPreTaskOrderList(),e.isLoading=!1}),1e3)},removeItemFromParent:function(e){for(var t=0,r=0;r<this.preTaskOrderList.length;r++)if(this.preTaskOrderList[r].id===e){t=r;break}this.preTaskOrderList.splice(t,1)}},mounted:function(){this.onRefresh()}},c=i,d=r("2877"),l=Object(d["a"])(c,a,o,!1,null,"85b4a5de",null);t["default"]=l.exports},d6c7:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("keep-alive",[e.$route.meta.keepAlive?r("router-view"):e._e()],1),e.$route.meta.keepAlive?e._e():r("router-view"),r("van-tabbar",{model:{value:e.active,callback:function(t){e.active=t},expression:"active"}},[r("van-tabbar-item",{attrs:{replace:"",to:"/deliveryman",icon:"home-o"}},[e._v("主页")]),r("van-tabbar-item",{attrs:{replace:"",to:"/deliveryman/queue",icon:"todo-list-o"}},[e._v("送单队列")]),r("van-tabbar-item",{attrs:{replace:"",to:"/deliveryman/mine",icon:"user-o"}},[e._v("我的")])],1)],1)},o=[],n={name:"GlobalContainer",data:function(){return{active:0}}},s=n,i=r("2877"),c=Object(i["a"])(s,a,o,!1,null,"0f03a3ab",null);t["default"]=c.exports},f7f5:function(e,t,r){}}]);
//# sourceMappingURL=delivery-home.0e15ecca.js.map